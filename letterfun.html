<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Alphabet Talk</title>
  <style>
    :root{
      --bg: #fff; --fg: #111; --muted: #6b7280;
      --btn-bg: #f3f4f6; --btn-fg: #111; --btn-hover: #e5e7eb; --btn-active: #d1d5db;
      --accent: #2563eb; --accent-2: #ef4444; --accent-3: #10b981; --accent-4: #f59e0b; --accent-5: #7c3aed;
    }
    @media (prefers-color-scheme: dark) {
      :root{
        --bg:#0b0f14; --fg:#e5e7eb; --muted:#9ca3af;
        --btn-bg:#111827; --btn-fg:#e5e7eb; --btn-hover:#1f2937; --btn-active:#374151;
        --accent:#60a5fa; --accent-2:#f87171; --accent-3:#34d399; --accent-4:#fbbf24; --accent-5:#a78bfa;
      }
    }
    html, body { height:100%; margin:0; background:var(--bg); color:var(--fg);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif; }
    .app { min-height:100%; display:grid; grid-template-rows:1fr auto; gap:16px; }

    .stage {
      position:relative; display:grid; place-items:center; padding:24px; overflow:hidden;
    }
    .letter {
      font-weight:800; font-size:clamp(72px,16vw,240px); line-height:1; letter-spacing:.02em;
      user-select:none; -webkit-user-select:none; transition:transform 120ms ease, text-shadow 120ms ease, color 120ms ease;
      will-change:transform, color, text-shadow;
    }
    .letter.empty::after { content:""; }

    .controls {
      position:sticky; bottom:0;
      padding:10px 10px calc(10px + env(safe-area-inset-bottom));
      background:linear-gradient(to top, color-mix(in oklab,var(--bg) 92%, transparent), transparent 24px);
      backdrop-filter: blur(6px);
    }
    .row { display:grid; grid-template-columns: repeat(auto-fit, minmax(44px,1fr)); gap:8px; align-items:center; }
    button {
      appearance:none; border:1px solid var(--btn-hover); border-radius:10px;
      background:var(--btn-bg); color:var(--btn-fg); padding:10px 0;
      font-weight:700; font-size:16px; line-height:1; cursor:pointer;
      transition: transform 80ms ease, background 80ms ease, border-color 80ms ease;
    }
    button:hover { background:var(--btn-hover); }
    button:active { background:var(--btn-active); transform:translateY(1px); }
    button:focus-visible { outline:3px solid var(--accent); outline-offset:2px; }
    .btn--wide { grid-column: span 2; }
    @media (min-width: 720px) { .btn--wide { grid-column: span 1; } }
    .actions { margin-top:8px; }

    /* ---------- Effects (class-based) ---------- */
    @keyframes fx-shake { 10%,90%{transform:translate(-1px,0) rotate(-0.5deg)}
      20%,80%{transform:translate(2px,0) rotate(0.5deg)}
      30%,50%,70%{transform:translate(-2px,0) rotate(-1deg)}
      40%,60%{transform:translate(2px,0) rotate(1deg)} }
    .is-shaking { animation: fx-shake 500ms ease-in-out both; }

    @keyframes fx-pulse { 0%{transform:scale(1)} 50%{transform:scale(1.2); color:var(--accent)} 100%{transform:scale(1)} }
    .is-pulsing { animation: fx-pulse 600ms ease-in-out both; }

    @keyframes fx-spin { 0%{transform:rotateY(0) scale(1)} 50%{transform:rotateY(180deg) scale(1.12); color:var(--accent-5)} 100%{transform:rotateY(360deg) scale(1)} }
    .is-spinning { animation: fx-spin 800ms ease-in-out both; transform-style:preserve-3d; }

    @keyframes fx-bounce { 0%,100%{transform:translateY(0)} 30%{transform:translateY(-24px)} 60%{transform:translateY(-8px)} }
    .is-bouncing { animation: fx-bounce 600ms ease both; }

    @keyframes fx-rainbow {
      0%{color:var(--accent)} 20%{color:var(--accent-2)} 40%{color:var(--accent-3)} 60%{color:var(--accent-4)} 80%{color:var(--accent-5)} 100%{color:var(--fg)}
    }
    .is-rainbow { animation: fx-rainbow 900ms linear both; }

    /* New effects */
    @keyframes fx-jelly { 0%{transform:scale(1,1)} 30%{transform:scale(1.25,0.8)} 55%{transform:scale(0.9,1.1)} 75%{transform:scale(1.05,0.97)} 100%{transform:scale(1,1)} }
    .is-jelly { animation: fx-jelly 700ms ease both; }

    @keyframes fx-tilt { 0%{transform:rotate(-8deg)} 50%{transform:rotate(8deg)} 100%{transform:rotate(0)} }
    .is-tilting { animation: fx-tilt 500ms ease both; }

    @keyframes fx-glow { 0%{text-shadow:0 0 0 rgba(0,0,0,0)} 50%{text-shadow:0 0 28px color-mix(in oklab, var(--accent) 60%, white)} 100%{text-shadow:0 0 0 rgba(0,0,0,0)} }
    .is-glowing { animation: fx-glow 900ms ease both; }

    @keyframes fx-squash { 0%{transform:scale(1)} 40%{transform:scale(1.35,0.75)} 100%{transform:scale(1)} }
    .is-squash { animation: fx-squash 420ms ease-out both; }

    @keyframes fx-wobble { 0%{transform:rotate(0)} 15%{transform:rotate(-10deg)} 30%{transform:rotate(8deg)} 45%{transform:rotate(-6deg)} 60%{transform:rotate(4deg)} 75%{transform:rotate(-2deg)} 100%{transform:rotate(0)} }
    .is-wobbling { animation: fx-wobble 700ms ease-out both; }

    /* ---------- Generated visuals ---------- */
    .burst, .confetti, .ring, .trail { position:absolute; inset:0; pointer-events:none; }
    .burst span, .ring span { position:absolute; font-weight:800; opacity:0; transform:translate(-50%,-50%) scale(0.6); }
    @keyframes fx-burst { 0%{opacity:0; transform:translate(-50%,-50%) scale(0.6)} 30%{opacity:1}
      100%{opacity:0; transform:translate(-50%,-120%) scale(1.4)} }
    .burst span { animation: fx-burst 700ms ease-out forwards; color: var(--accent-3); }

    .confetti i { position:absolute; width:8px; height:8px; border-radius:2px; opacity:0; transform:translate(-50%,-50%) scale(0.8); }
    @keyframes fx-confetti { 0%{opacity:0; transform:translate(-50%,-50%) translateY(-10px) scale(0.8)}
      15%{opacity:1}
      100%{opacity:0; transform:translate(-50%,-50%) translateY(140px) rotate(180deg) scale(1)} }

    .trail b { position:absolute; font-weight:800; opacity:0.25; transform:translate(-50%,-50%); filter:blur(1px); }
    @keyframes fx-trail { 0%{opacity:0.25} 100%{opacity:0; transform:translate(-50%,-50%) scale(1.3)} }

    /* Ring of letters expanding outward */
    @keyframes fx-ring { 0%{opacity:0; transform:translate(-50%,-50%) scale(0.6)} 20%{opacity:1} 100%{opacity:0; transform:translate(-50%,-50%) scale(1.6)} }
    .ring span { animation: fx-ring 900ms ease-out forwards; color: var(--accent-4); }

    /* Blank press hint */
    .stage.flash { box-shadow: inset 0 0 0 4px var(--accent-2); animation: fx-flash 600ms ease-out; }
    @keyframes fx-flash { 0%,100%{box-shadow: inset 0 0 0 0 var(--accent-2);} 20%{box-shadow: inset 0 0 0 8px var(--accent-2);} }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      .is-shaking,.is-pulsing,.is-spinning,.is-bouncing,.is-rainbow,.is-jelly,.is-tilting,.is-glowing,.is-squash,.is-wobbling,
      .burst span,.confetti i,.trail b,.ring span { animation-duration:1ms !important; }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Display area -->
    <main class="stage" aria-labelledby="display-label" id="stage">
      <h1 id="display-label" class="visually-hidden" style="position:absolute;left:-9999px;">Displayed character</h1>
      <div id="display" class="letter empty" aria-live="polite" aria-atomic="true"></div>
      <!-- effect layers get injected here -->
    </main>

    <!-- Controls -->
    <footer class="controls" aria-label="Alphabet controls">
      <div class="row" id="alpha-row"><!-- A–Z buttons injected by JS --></div>
      <div class="row actions">
        <button type="button" data-char="" class="btn--wide" aria-label="Make screen blank">Blank</button>
        <button type="button" data-char="?" class="btn--wide" aria-label="Show question mark">?</button>
      </div>
    </footer>
  </div>

  <script>
    const display = document.getElementById('display');
    const alphaRow = document.getElementById('alpha-row');
    const stage = document.getElementById('stage');

    // Build A–Z buttons
    for (let i = 0; i < 26; i++) {
      const ch = String.fromCharCode('A'.charCodeAt(0) + i);
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.textContent = ch;
      btn.setAttribute('data-char', ch);
      btn.setAttribute('aria-label', `Show ${ch}`);
      alphaRow.appendChild(btn);
    }

    // Click handling: if the same char is pressed, do a random action; else set it
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('button[data-char]');
      if (!btn) return;
      const ch = btn.getAttribute('data-char');
      handleCharInput(ch);
    });

    // Keyboard: A–Z, '?', Space(blank). Re-pressing same letter triggers random action.
    document.addEventListener('keydown', (e) => {
      const key = e.key;
      if (/^[a-z]$/i.test(key)) {
        handleCharInput(key.toUpperCase());
      } else if (key === '?') {
        handleCharInput('?');
      } else if (key === ' ') {
        e.preventDefault();
        handleCharInput('');
      }
    });

    function handleCharInput(ch) {
      const current = display.textContent;
      if (ch === '') {
        setDisplay('');
        return;
      }
      if (current === ch) {
        doRandomAction();
      } else {
        setDisplay(ch);
      }
    }

    function setDisplay(char) {
      display.textContent = char || '';
      display.classList.toggle('empty', !char);
      // tiny pop
      display.style.transform = 'scale(1.04)';
      requestAnimationFrame(() => setTimeout(() => display.style.transform = 'scale(1.0)', 80));
    }

    // ------- Random Effects -------
    const classEffects = [
      'is-shaking','is-pulsing','is-spinning','is-bouncing','is-rainbow',
      'is-jelly','is-tilting','is-glowing','is-squash','is-wobbling'
    ];
    function doRandomAction() {
      const hasChar = display.textContent && display.textContent.length > 0;
      if (!hasChar) {
        stage.classList.add('flash');
        setTimeout(() => stage.classList.remove('flash'), 600);
        return;
      }
      // 50/50 between class effect and generated effect
      const generators = [burstLetters, confetti, ringLetters, echoTrail];
      if (Math.random() < 0.5) {
        applyClassEffect();
      } else {
        const fn = generators[Math.floor(Math.random() * generators.length)];
        fn(display.textContent);
      }
    }

    function applyClassEffect() {
      classEffects.forEach(c => display.classList.remove(c));
      const effect = classEffects[Math.floor(Math.random() * classEffects.length)];
      void display.offsetWidth; // reflow to restart animation
      display.classList.add(effect);
      setTimeout(() => display.classList.remove(effect), 1000);
    }

    // Floating duplicates
    function burstLetters(ch) {
      const layer = document.createElement('div');
      layer.className = 'burst';
      stage.appendChild(layer);
      const rect = stage.getBoundingClientRect();
      const count = 14 + Math.floor(Math.random() * 10);
      for (let i = 0; i < count; i++) {
        const s = document.createElement('span');
        s.textContent = ch;
        const x = Math.random() * rect.width;
        const y = (rect.height * 0.45) + (Math.random() * rect.height * 0.3);
        s.style.left = x + 'px';
        s.style.top = y + 'px';
        s.style.fontSize = (32 + Math.random() * 96) + 'px';
        s.style.animationDelay = (i * 12) + 'ms';
        layer.appendChild(s);
      }
      setTimeout(() => layer.remove(), 900);
    }

    // Colorful confetti squares from the letter position
    function confetti() {
      const layer = document.createElement('div');
      layer.className = 'confetti';
      stage.appendChild(layer);
      const center = centerOf(display, stage);
      const colors = [ 'var(--accent)', 'var(--accent-2)', 'var(--accent-3)', 'var(--accent-4)', 'var(--accent-5)' ];
      const count = 28 + Math.floor(Math.random() * 20);
      for (let i = 0; i < count; i++) {
        const dot = document.createElement('i');
        dot.style.left = center.x + 'px';
        dot.style.top = center.y + 'px';
        dot.style.background = colors[i % colors.length];
        dot.style.transform += ` rotate(${Math.random()*360}deg)`;
        dot.style.animation = `fx-confetti ${650 + Math.random()*300}ms ease-out forwards`;
        dot.style.animationDelay = (i*6)+'ms';
        dot.style.width = (6 + Math.random()*6)+'px';
        dot.style.height = dot.style.width;
        // random horizontal drift
        dot.style.setProperty('--dx', (Math.random()*160-80)+'px');
        dot.animate([
          { transform:`translate(-50%,-50%) translateX(0) translateY(-10px) rotate(0deg)` , opacity:0 },
          { transform:`translate(-50%,-50%) translateX(${Math.random()*160-80}px) translateY(140px) rotate(${Math.random()*360}deg)`, opacity:0 }
        ], { duration: 650 + Math.random()*300, easing:'ease-out', fill:'forwards' });
        layer.appendChild(dot);
      }
      setTimeout(() => layer.remove(), 1200);
    }

    // Expanding ring of letters around the current one
    function ringLetters(ch) {
      const layer = document.createElement('div');
      layer.className = 'ring';
      stage.appendChild(layer);
      const center = centerOf(display, stage);
      const n = 12;
      const radius = 80;
      for (let i = 0; i < n; i++) {
        const s = document.createElement('span');
        s.textContent = ch;
        const angle = (i / n) * Math.PI * 2;
        s.style.left = (center.x + Math.cos(angle) * radius) + 'px';
        s.style.top  = (center.y + Math.sin(angle) * radius) + 'px';
        s.style.fontSize = '40px';
        s.style.animationDelay = (i*15)+'ms';
        layer.appendChild(s);
      }
      setTimeout(() => layer.remove(), 1100);
    }

    // Echo trail that fades out
    function echoTrail(ch) {
      const layer = document.createElement('div');
      layer.className = 'trail';
      stage.appendChild(layer);
      const center = centerOf(display, stage);
      const echoes = 9;
      for (let i = 0; i < echoes; i++) {
        const b = document.createElement('b');
        b.textContent = ch;
        const jitterX = (Math.random()*24 - 12);
        const jitterY = (Math.random()*24 - 12);
        b.style.left = (center.x + jitterX) + 'px';
        b.style.top = (center.y + jitterY) + 'px';
        b.style.fontSize = (display.getBoundingClientRect().height * 0.6) + 'px';
        b.style.color = 'currentColor';
        b.style.animation = `fx-trail ${350 + i*40}ms ease-out forwards`;
        layer.appendChild(b);
      }
      setTimeout(() => layer.remove(), 900);
    }

    function centerOf(el, relativeTo) {
      const r1 = el.getBoundingClientRect();
      const r2 = relativeTo.getBoundingClientRect();
      return { x: r1.left - r2.left + r1.width/2, y: r1.top - r2.top + r1.height/2 };
    }

    // Start blank
    setDisplay('');
  </script>
</body>
</html>
